<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daftar Pengguna</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <style>
    .active-link {
      background-color: #4a5568; /* bg-gray-700 */
    }
  </style>
  <body class="bg-gray-100">
    <div class="flex">
      <!-- Sidebar -->
      <div class="sidebar bg-gray-800 text-white h-screen w-64 pt-20">
        <div class="user-info text-center py-2 border-b border-gray-600 mb-4">
          <h4 class="text-xl italic font-bold">Welcome Back, {{.Username}}</h4>
          <p class="text-sm">Role : {{.Role}}</p>
        </div>

        <a
          href="/manageUser"
          class="block py-2 px-4 text-white hover:bg-gray-700 flex items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6 mr-2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
            />
          </svg>
          Manage Users
        </a>
        <a
          href="/manageMember"
          class="block py-2 px-4 text-white hover:bg-gray-700 flex items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6 mr-2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"
            />
          </svg>
          Manage Member
        </a>
        <a
          href="/manageItem"
          class="block py-2 px-4 text-white hover:bg-gray-700 flex items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6 mr-2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"
            />
          </svg>
          Manage Item
        </a>
        <a
          href="/manageHistoryPenjualan"
          class="block py-2 px-4 text-white hover:bg-gray-700 flex items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6 mr-2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75"
            />
          </svg>
          Manage History Penjualan
        </a>
        <a
          href="/logout"
          class="block py-2 px-4 text-white hover:bg-gray-700 flex items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6 mr-2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"
            />
          </svg>
          Logout
        </a>
      </div>

      <!-- Content -->
      <div class="content flex-grow p-6">
        <h1 class="text-3xl font-bold mb-4">Daftar Pengguna</h1>
        <h2 id="manage-user" class="text-2xl font-bold mb-4">Manage User</h2>
        <button
          id="add-user-btn"
          onclick="goToInsertUser()"
          class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded-lg mb-4"
        >
          Tambah User
        </button>
        <script>
          function goToInsertUser() {
            window.location.href = "/insertUser";
          }

          document.addEventListener("DOMContentLoaded", function () {
            const urlParams = new URLSearchParams(window.location.search);
            const loginSuccess = urlParams.get("login") === "success";
            const username = "{{.Username}}";
            const userId = "{{.Id}}";

            if (loginSuccess) {
              alert("Selamat datang, " + username + "!");
            }
          });

          function updateUser(button) {
            var Id = button.getAttribute("data-id");
            console.log("Updating user with ID:", Id); // Debugging: Log ID
            window.location.href = "/updateUser?Id=" + Id;
          }

          function deleteUser(button) {
            var Id = button.getAttribute("data-id");
            console.log("Deleting user with ID:", Id); // Debugging: Log ID
            window.location.href = "/deleteUser?Id=" + Id;
          }
        </script>
        <script>
          document.addEventListener("DOMContentLoaded", function () {
            const links = document.querySelectorAll(".sidebar a");

            // Set active class on the link matching current URL
            links.forEach((link) => {
              if (link.href === window.location.href) {
                link.classList.add("active-link");
              }
            });

            // Add click event listener to each link
            links.forEach((link) => {
              link.addEventListener("click", function () {
                // Remove active class from all links
                links.forEach((l) => l.classList.remove("active-link"));
                // Add active class to the clicked link
                this.classList.add("active-link");
              });
            });
          });
        </script>
        <div class="overflow-x-auto">
          <table id="user-table" class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-800 text-white">
              <tr>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"
                >
                  ID
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"
                >
                  Username
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"
                >
                  Password
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"
                >
                  Role
                </th>
                <th
                  scope="col"
                  class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"
                >
                  Aksi
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              {{range .Users}}
              <tr>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm text-gray-900">{{.Id}}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm text-gray-900">{{.Username}}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm text-gray-900">{{.Password}}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm text-gray-900">{{.Role}}</div>
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-left text-sm font-medium"
                >
                  <button
                    onclick="updateUser(this)"
                    data-id="{{.Id}}"
                    class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded-lg mr-2"
                  >
                    Update
                  </button>
                  <button
                    onclick="deleteUser(this)"
                    data-id="{{.Id}}"
                    class="bg-red-600 hover:bg-red-800 text-white py-2 px-4 rounded-lg"
                  >
                    Delete
                  </button>
                </td>
              </tr>
              {{end}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
